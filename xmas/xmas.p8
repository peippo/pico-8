pico-8 cartridge // http://www.pico-8.com
version 36
__lua__
-- xmas is coming
-- by peippo

function _init()
    flakes = {}
    flake_colors = {5, 6, 7}
    wind_speeds = {-0.4, -0.2, 0, 0.2, 0.4}
    wind = rnd(wind_speeds)
end
   
function _draw()
    cls(0)
    
    --background
    map(16,0,0,0,16,16)
    
    --foreground
    map(0,0,0,0,16,16)
    
    add_flake()

    for flake in all(flakes) do
        flake:draw()
    end
end

function _update60()
    randomize_wind()

    for flake in all(flakes) do
        flake:update(wind)
    end
end
-->8
-- snow flakes

function add_flake()
    add(flakes, {
        x = random(-128 - 64, 128 + 64),
        y = -5,
        size = rnd(2),
        color = rnd(flake_colors),
        draw = function(self)
            circfill(self.x, self.y, self.size, self.color)
        end,
        update = function(self, wind)
            self.x = self.x + wind + sin(time() * rnd(3))
            self.y += rnd(2)

            if (self.y > 128) then
                del(flakes, self)
            end
        end
    })
end

function randomize_wind()
    change_wind = time() % 5 == 0

    if change_wind then
        wind = rnd(wind_speeds)
    end
end
-->8
-- utility functions

function random(a, b)
    if (a > b) a, b = b, a
    return a + flr(rnd(b - a + 1))
end
__gfx__
00000000000000006666666666666666666666666666666600000000000000000000000000000000000001111110000000000000000000000000000000000000
00000000000000007777777777777777777777777777777700006660000000000000000060666600000111111111100000000000000000000000000000000000
00000000343343437776777667667776666777666677666600066676d06660000006600666766660001111111111110000000000000000000000000000000000
00000000666666665655676556556765556666655566555500666777666676000066760067776660011111111111111000000000000000000000000000000000
000000006d5656d545445652455556544445665444555744dd666676666777000067776656766660011111111111111000000000000000000000000000000000
0000000055656d56244e45222477454424245544244466620d666666666676000006756665666660111111111111111100000000000000000000000000000000
00000000505505554422244244666444422254244644565400066666d06660000000666666666600111111111111111100000000000000000000000000000000
00000000000000004442444444565444442444444544454400006665600dddd0ddd00566765dd000111111111111111100000000000000000000000000000000
0000000000000000444444444444444444444444444444440000055766ddd20000dd665777d26600111111110000000110000000000000000000000000000000
0000000000000000444444444444444444444244444444440000067776d200000006676d7d066760111111110000001111000000000000000000000000000000
000000000000000044444244467442444444222444e4444400000667662000000006666dd0066660111111110000011111100000000000000000000000000000
00000000000000004244444446644444444442444222444400000066600000000000660dd0dd6600111111110000111111110000000000000000000000000000
000000000000000022244424455444242444444444244644000000ddd00000000000000ddd200000111111110001111111111000000000000000000000000000
0000000000000000424424444444244244242444444445420000000ddd0000000000000ddd000000111111110011111111111100000000000000000000000000
0000000000000000444444424444444442444444424244440000000ddd200000000000dd20000000111111110111111111111110000000000000000000000000
0000000000000000244444242444444444444424244444240000000ddd200000000000dd20000000111111111111111111111111000000000000000000000000
00000000000000000006666666666000244444444444444000000d00000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000677777777777770024442444424442000066d00000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000776777666677760004422244222440000667600000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000056556765556666650024424444244200006666dd000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000045445652444566540024444444444200d0066d00000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000244e45222424554202242444444242200dd0d200000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000044222442422254240244444444444420002dd000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000244244444424444202444444444444200000d000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000024444444444442000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000024444444444442000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000002e4444444444e2000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000022244444444222000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000022446444464422000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000002445422454420000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000002444444444420000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000004444444444440000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000007779999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000aaa9999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000994440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000994440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000077777777777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000729766666666666000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000007299976666676676600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000072999997666666777660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000729999999766666676666000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00007299922999976666666676600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00072999244299997666666767660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00729999444499999766666676666000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
07299999a44a99999976667666666600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
729999999aa999999997666666676660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
29999999999999999999766666666666000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
09999994444449949992222222222220000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
09999494222249994994444444444440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
09949994222249499492444444244240000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
09494944242249994944242444442420000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
04949494222249949492424242424240000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000001b1a1a0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000040000000000000000000000a1c00000000001a1a1a1a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000a1a0b001a1a000000000a1a1a1a1a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000001a1a1a1b1a1a0a1a1a1c1a1a1a1a1a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000051520000001a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000006061626300001a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000007071727300001a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000220504020323001a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000241414121525001a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000809000607000000121414131235001a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001819261617000000341312151225001a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
020503020304020404050402030402051a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
151214121514131215121412121512141a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

