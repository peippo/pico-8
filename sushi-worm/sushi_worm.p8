pico-8 cartridge // http://www.pico-8.com
version 36
__lua__
--sushi-worm

function _init()
    worm = init_worm()
    sushi = init_sushi()
end

function _update()
    worm:update()
end

function _draw()
    cls(0)
    map(0,0,0,0,16,16)
    worm:draw()
    sushi:draw()
end
-->8
-- worm

function init_worm()
    return {
        body = {},
        x = 64,
        y = 64,
        length = 10,
        turn_speed = 10,
        dir = 90,
        draw = function(self)
            for p in all(self.body) do
                pset(p.x,p.y,1)
            end
            
            print(self.dir, 10, 4, 1)
            print(self.dir, 10, 3, 15)            
        end,
        update = function(self)
            local pixel = {}

            if (self.dir >= 0 and self.dir <= 89) then
                add(self.body, {
                    x = self.x+1,
                    y = self.y-1
                })
                self.x+=1
                self.y-=1
            end

            if (self.dir >= 90 and self.dir <= 179) then
                add(self.body, {
                    x = self.x+1,
                    y = self.y+1
                })
                self.x+=1
                self.y+=1
            end

            if (self.dir >= 179 and self.dir <= 269) then
                add(self.body, {
                    x = self.x-1,
                    y = self.y+1
                })
                self.x-=1
                self.y+=1
            end

            if (self.dir >= 269 and self.dir <= 360) then
                add(self.body, {
                    x = self.x-1,
                    y = self.y-1
                })
                self.x-=1
                self.y-=1
            end

            -- controls
            if (btn(0)) then self.dir-=self.turn_speed end
            if (btn(1)) then self.dir+=self.turn_speed end

            if (self.dir > 360) then self.dir = 0 end
            if (self.dir < 0) then self.dir = 360 end

            -- wrap around edges
            if (self.x > 119) then self.x = 10 end
            if (self.y > 119) then self.y = 11 end
            if (self.x < 9) then self.x = 120 end
            if (self.y < 10) then self.y = 120 end

            -- body length
            if (#self.body > self.length) then deli(self.body, 1) end

            -- check for sushi collect
            if self.x > sushi.x
            and self.x < sushi.x + 8
            and self.y > sushi.y
            and self.y < sushi.y + 8
            then
                sushi:collect()
            end
        end
    }
end
-->8
-- sushi

function init_sushi()
    return {
        x = 20,
        y = 20,
        sprite = get_random_sprite(),
        draw = function(self)            
            -- shadow
            for c=0,15 do
                pal(c, 0)
            end
            spr(self.sprite, self.x, self.y + 1)
            pal()

            -- sprite
            spr(self.sprite, self.x, self.y)
        end,
        collect = function(self)
            self.sprite = get_random_sprite()

            local pos = get_random_position()
            self.x = pos.x
            self.y = pos.y

            worm.length+=5
        end

    }
end

function get_random_sprite()
    return flr(rnd(5) + 1)
end


function get_random_position()
    local pos = {}
    pos.x = rnd(88) + 20
    pos.y = rnd(88) + 20

    return pos
end
__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000222200330000b30000000000766700007337000b00b030000000000000000000000000000000000000000000000000000000000000000000000000
0000000008eeeee033b5bb33ffa5a7fa076ee6700763b3700333b3b0000000000000000000000000000000000000000000000000000000000000000000000000
000000008e88888803315330999459990d7ee7d00d7335d033b33333000000000000000000000000000000000000000000000000000000000000000000000000
000000008e888888067657600677576001d77d1001d77d1000333300000000000000000000000000000000000000000000000000000000000000000000000000
00000000827777780777577007775770011111100111111001130110000000000000000000000000000000000000000000000000000000000000000000000000
00000000266776600667566006675660011111100111111001101110000000000000000000000000000000000000000000000000000000000000000000000000
00000000006666000066560000665600001111000011110000111100000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444666666664444444460f444444f44440660444444ff444406666666666666666600000000000000000000000000000000000000000000000000000000
fffffff400000000ffffffff60f444444f44440660000004f0000006600006000060000600000000000000000000000000000000000000000000000000000000
fffffff4ffffffff4444444460f444444f4444066ddddd0440ddddd660ddd604406ddd0600000000000000000000000000000000000000000000000000000000
fffffff4444444444444444460f444444f4444066066660440666606606666044066660600000000000000000000000000000000000000000000000000000000
fffffff4444444444444444460f444444f4444066066660440666606606666044066660600000000000000000000000000000000000000000000000000000000
fffffff4444444444444444460f444444f44440660666604406666066d666604406666d600000000000000000000000000000000000000000000000000000000
fffffff4444444440000000060f444444f4444066000060000600006600000044000000600000000000000000000000000000000000000000000000000000000
fffffff444444444dddddddd60f444444f4444066dddd6dddd6dddd6604444444444440600000000000000000000000000000000000000000000000000000000
44444444040444444444444444444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000fffff40000000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0f0f0f040f0ffff40f0f0f040f0f0f04000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
f0f0f0f000fffff400f0f0f0f0f0f0f4000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
fffffff40f0ffff40f0ffff4fffffff4000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
fffffff400fffff400fffff4fffffff4000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
fffffff40f0ffff40f0ffff4fffffff4000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
fffffff400fffff400fffff4fffffff4000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000666666666666666666666666666666666666666666666666666666666666666666666666
00000000000000000000000000000000000000000000000000000000888888888888888888888888888888888888888888888888888888888888888888888888
00000000000000000000000000000000000000000000000000000000888888888888888888888888888888888888888888888888888888888888888888888888
000000000000000000000000000000000000000000000000000000008888888888aaaaa88a8888a88a8888a88aaaaa888a8888a888aaaa888aaaaa8888a88a88
00000000000000000000000000000000000000000000000000000000888888888988888889888898898888988889888889888898898888988988889889899898
000000000000000000000000000000000000000000000000000000008aaaaa888899998889888898899999988889888889899898898888988988889889899898
00000000000000000000000000000000000000000000000000000000899999888888889889888898898888988889888889899898898888988989998889888898
00000000000000000000000000000000000000000000000000000000888888888999998888999988898888988999998888988988889999888988889889888898
00000000000000000000000000000000000000000000000000000000888888886666666666666666000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000888888880000088888800000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000008888888fffff888888fffff000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000f02882204444488888844444000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000fff000f44444488888844444000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000fffffff44444408888044444000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000fffffff44444448888444444000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000fffffff44444440880444444000000000000000000000000000000000000000000000000
__map__
4741414141414141414141414141414800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4352505050505050505050505050534400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4351404040404040404040404040404400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4351404040404040404040404040404400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4351404040404040404040404040404400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4351404040404040404040404040404400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4351404040404040404040404040404400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4351404040404040404040404040404400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4351404040404040404040404040404400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4351404040404040404040404040404400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4351404040404040404040404040404400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4351404040404040404040404040404400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4351404040404040404040404040404400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4351404040404040404040404040404400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4351404040404040404040404040404400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4542424242424242424242424242424600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

